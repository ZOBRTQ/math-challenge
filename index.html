<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ•°å­¦å¼ºå›½æŒ‘æˆ˜èµ›</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.css">
    <style>
        body {
            font-family: 'Microsoft YaHei', sans-serif;
            background-color: #f0f8ff;
            color: #333;
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
        }
        .header {
            text-align: center;
            margin-bottom: 30px;
        }
        .header h1 {
            color: #e74c3c;
            font-size: 2.2em;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
        }
        
        .user-progress {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            background-color: white;
            border-radius: 10px;
            padding: 15px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        .avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background-color: #3498db;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            cursor: pointer;
        }
        .progress-container {
            flex: 1;
            margin-left: 20px;
        }
        .progress-bar {
            height: 10px;
            background-color: #f1f1f1;
            border-radius: 5px;
            overflow: hidden;
            margin: 5px 0;
            position: relative;
        }
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #3498db, #2ecc71);
            width: 33%;
        }
        .progress-star {
            position: absolute;
            top: -10px;
            font-size: 20px;
            color: #f1c40f;
            opacity: 0.3;
        }
        .progress-star.active {
            opacity: 1;
        }
        
        .dashboard {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        .dashboard-card {
            background-color: white;
            border-radius: 10px;
            padding: 15px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        .dashboard-card h3 {
            margin-top: 0;
            border-bottom: 1px solid #eee;
            padding-bottom: 10px;
        }
        
        .achievement-preview {
            display: flex;
            overflow-x: auto;
            gap: 10px;
            padding: 10px 0;
        }
        .achievement-badge {
            min-width: 60px;
            height: 60px;
            background-color: #ddd;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5em;
        }
        .achievement-badge.unlocked {
            background-color: #f1c40f;
            color: white;
        }
        
        .report-item {
            display: flex;
            justify-content: space-between;
            margin: 10px 0;
            padding: 8px;
            background-color: #f9f9f9;
            border-radius: 5px;
        }
        
        .wrong-question {
            margin: 10px 0;
            padding: 10px;
            background-color: #f8d7da;
            border-radius: 5px;
            border-left: 3px solid #e74c3c;
        }
        
        .chapter-selector {
            background-color: white;
            border-radius: 10px;
            padding: 15px;
            margin: 20px 0;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        select {
            width: 100%;
            padding: 10px;
            border: 2px solid #ddd;
            border-radius: 5px;
            font-size: 1em;
            margin-top: 10px;
        }
        
        .level-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }
        .level-card {
            background-color: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            transition: transform 0.3s;
            cursor: pointer;
            position: relative;
        }
        .level-card:hover {
            transform: translateY(-5px);
        }
        .level-card.completed {
            border-left: 5px solid #2ecc71;
        }
        .level-card.locked {
            filter: grayscale(80%);
            cursor: not-allowed;
        }
        .level-badge {
            position: absolute;
            top: 10px;
            right: 10px;
            background-color: #e74c3c;
            color: white;
            padding: 3px 8px;
            border-radius: 10px;
            font-size: 0.8em;
        }
        .level-progress {
            height: 5px;
            background-color: #f1f1f1;
            margin-top: 15px;
            border-radius: 3px;
            overflow: hidden;
        }
        .level-progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #3498db, #2ecc71);
            width: 0%;
        }
        
        .question-preview {
            margin: 10px 0;
            padding: 10px;
            background-color: #f9f9f9;
            border-radius: 5px;
            font-size: 0.9em;
        }
        
        .game-container {
            position: relative;
        }
        .question-card {
            background-color: white;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        
        .question-image {
            width: 100%;
            max-width: 400px;
            margin: 15px auto;
            border: 1px solid #ddd;
            border-radius: 5px;
            padding: 5px;
            background-color: white;
        }
        .question-image img {
            width: 100%;
            display: block;
        }
        .image-placeholder {
            width: 100%;
            height: 200px;
            background-color: #f5f5f5;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #999;
            font-size: 0.9em;
        }
        
        .answer-input {
            margin: 15px 0;
            position: relative;
        }
        .answer-input input {
            width: 100%;
            padding: 10px;
            border: 2px solid #ddd;
            border-radius: 5px;
            font-size: 1em;
            margin-top: 5px;
        }
        .answer-input label {
            font-weight: bold;
        }
        
        .error-message {
            color: #e74c3c;
            margin: 5px 0;
            font-weight: bold;
            display: none;
        }
        
        .success-message {
            color: #2ecc71;
            margin: 5px 0;
            font-weight: bold;
            display: none;
        }
        
        .btn {
            background-color: #e74c3c;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.9em;
            transition: all 0.3s;
            margin: 5px;
        }
        .btn:hover {
            background-color: #c0392b;
        }
        .btn-secondary {
            background-color: #3498db;
        }
        .btn-secondary:hover {
            background-color: #2980b9;
        }
        .btn-small {
            padding: 5px 10px;
            font-size: 0.8em;
        }
        
        .back-button {
            position: fixed;
            top: 10px;
            right: 10px;
            z-index: 1000;
            background-color: #3498db;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.9em;
        }
        .back-button:hover {
            background-color: #2980b9;
        }

        /* æ•°å­¦å…¬å¼æ ·å¼ */
        .katex { font-size: 1.1em; }
        .math-formula {
            margin: 10px 0;
            padding: 10px;
            background-color: #f8f9fa;
            border-radius: 3px;
            overflow-x: auto;
        }

        /* æ–°å¢æŒ‰é’®äº¤äº’æ ·å¼ */
        #submitAnswerBtn, #showSolutionBtn {
            transition: all 0.3s;
            position: relative;
        }
        #submitAnswerBtn:active {
            transform: translateY(2px);
        }
        #submitAnswerBtn.loading {
            opacity: 0.7;
            pointer-events: none;
        }
        #submitAnswerBtn.loading::after {
            content: "Â·Â·Â·";
            position: absolute;
            right: 15px;
            animation: loadingDots 1.5s infinite;
        }
        @keyframes loadingDots {
            0%, 20% { content: "Â·"; }
            40% { content: "Â·Â·"; }
            60%, 100% { content: "Â·Â·Â·"; }
        }
    </style>
</head>
<body>
    <!-- é¦–é¡µ -->
    <div class="home-container" id="homePage">
        <div class="header">
            <h1>æ•°å­¦å¼ºå›½æŒ‘æˆ˜èµ›</h1>
            <p>ç”¨æ•°å­¦åŠ©åŠ›ä¸­å›½ç§‘æŠ€è…¾é£ï¼</p>
        </div>

        <!-- ç”¨æˆ·ä¿¡æ¯ä¸è¿›åº¦ -->
        <div class="user-progress">
            <div class="avatar">
                <img src="image/ç”¨æˆ·å¤´åƒ.JPG" alt="ç”¨æˆ·å¤´åƒ" style="width:100%;border-radius:50%">
            </div>            
            <div class="progress-container">
                <h3>æœ¬ç« èŠ‚è¿›åº¦</h3>
                <div class="progress-bar">
                    <div class="progress-fill" id="overallProgress"></div>
                    <div class="progress-star" id="star1">â˜…</div>
                    <div class="progress-star" id="star2">â˜…</div>
                    <div class="progress-star" id="star3">â˜…</div>
                </div>
                <p>å·²å®Œæˆ <span id="completedCount">0</span>/<span id="totalCount">3</span> ä¸ªå…³å¡</p>
            </div>
        </div>

        <!-- ä»ªè¡¨ç›˜ -->
        <div class="dashboard">
            <!-- æˆå°±é¢„è§ˆ -->
            <div class="dashboard-card">
                <h3>ğŸ† æˆå°±é¢„è§ˆ</h3>
                <div class="achievement-preview">
                    <div class="achievement-badge unlocked">â­</div>
                    <div class="achievement-badge">ğŸ“¶</div>
                    <div class="achievement-badge">ğŸš„</div>
                    <div class="achievement-badge">ğŸ…</div>
                    <div class="achievement-badge">ğŸ’¯</div>
                </div>
                <button class="btn btn-secondary" onclick="showAchievements()">æŸ¥çœ‹å…¨éƒ¨æˆå°±</button>
            </div>
            
            <!-- å­¦ä¹ æŠ¥å‘Š -->
            <div class="dashboard-card">
                <h3>ğŸ“Š å­¦ä¹ æŠ¥å‘Š</h3>
                <div class="report-item">
                    <span>æ­£ç¡®ç‡</span>
                    <strong>75%</strong>
                </div>
                <div class="report-item">
                    <span>å¹³å‡ç”¨æ—¶</span>
                    <strong>2åˆ†15ç§’</strong>
                </div>
                <div class="report-item">
                    <span>æœ¬å‘¨å­¦ä¹ </span>
                    <strong>3å°æ—¶</strong>
                </div>
                <button class="btn btn-secondary" onclick="showReport()">è¯¦ç»†æŠ¥å‘Š</button>
            </div>
            
            <!-- é”™é¢˜æœ¬ -->
            <div class="dashboard-card">
                <h3>ğŸ” æœ€è¿‘é”™é¢˜</h3>
                <div class="wrong-question">
                    <p>æ±‚å‡½æ•°$f(x)=x+\frac{1}{x}$çš„æœ€å°å€¼</p>
                    <small>é”™è¯¯æ—¶é—´ï¼š2025-04-05</small>
                </div>
                <button class="btn btn-secondary" onclick="showWrongQuestions()">æŸ¥çœ‹é”™é¢˜æœ¬</button>
            </div>
        </div>

        <!-- ç« èŠ‚é€‰æ‹© -->
        <div class="chapter-selector">
            <h3>é€‰æ‹©å­¦ä¹ ç« èŠ‚</h3>
            <select id="chapterSelect">
                <option value="inequality" selected>é‡è¦ä¸ç­‰å¼</option>
                <option value="function">å‡½æ•°ä¸æé™</option>
                <option value="derivative">å¯¼æ•°ä¸åº”ç”¨</option>
                <option value="integral">ç§¯åˆ†å­¦</option>
            </select>
            <p id="chapterDesc">æœ¬ç« å­¦ä¹ é‡è¦ä¸ç­‰å¼åŠå…¶åº”ç”¨</p>
        </div>

        <!-- ä»Šæ—¥æŒ‘æˆ˜ -->
        <div class="chapter-selector" style="background-color: #fff9e6; border-left: 4px solid #f1c40f;">
            <h3>ğŸ“¢ ä»Šæ—¥æŒ‘æˆ˜ - <span id="currentChapter">é‡è¦ä¸ç­‰å¼</span></h3>
            <p>å®Œæˆæœ¬ç« å…¨éƒ¨å…³å¡å¯è·å¾—"ä¸ç­‰å¼å¤§å¸ˆ"æˆå°±ï¼</p>
            <div class="progress-bar">
                <div class="progress-fill" id="chapterProgress" style="width: 0%;"></div>
            </div>
            <p>æœ¬ç« è¿›åº¦ï¼š<span id="progressText">0/3</span></p>
        </div>

        <!-- å…³å¡å¡ç‰‡ -->
        <h2>é€‰æ‹©æŒ‘æˆ˜å…³å¡</h2>
        <div class="level-cards">
            <div class="level-card" id="level1" onclick="startLevel(1)">
                <div class="level-badge">è¿›é˜¶</div>
                <h3>ä¹˜ç§¯æœ€å¤§å€¼é—®é¢˜</h3>
                <div class="question-preview">
                    <p>å¤§ä¼šæ ‡è¯†ä¸­çš„é˜´é˜³æ‚¬è‡‚ä»£è¡¨æ•°å­—$2$å’Œ$7$ï¼Œä¹˜ç§¯ä¸º$14$(å±Šæ•°)ã€‚</p>
                    <p>è‹¥ä¸¤æ•°ä¹‹å’Œä¸º$9$ï¼Œæ±‚å…¶ç§¯çš„æœ€å¤§å€¼ã€‚</p>
                </div>
                <div class="level-progress">
                    <div class="level-progress-fill" style="width:0%"></div>
                </div>
                <p>ğŸ”œ å¼€å§‹æŒ‘æˆ˜</p>
            </div>
            
            <div class="level-card" id="level2" onclick="startLevel(2)">
                <div class="level-badge">åŸºç¡€</div>
                <h3>åŠåœ†é¢ç§¯æœ€å¤§é—®é¢˜</h3>
                <div class="question-preview">
                    <p>å¦‚å›¾ï¼Œç‚¹$D$æ˜¯ä»¥$AB$ä¸ºç›´å¾„($|AB|=3$)çš„åŠåœ†ä¸Šçš„åŠ¨ç‚¹ï¼Œå½“å–å¾—æœ€å¤§å€¼æ—¶ï¼š</p>
                    <ol type="a">
                        <li>æ±‚é¢ç§¯çš„æœ€å¤§å€¼</li>
                        <li>æ±‚æ­¤æ—¶ç›´çº¿$AB$ä¸ç›´çº¿$AD$å¤¹è§’çš„ä½™å¼¦å€¼</li>
                    </ol>
                </div>
                <div class="level-progress">
                    <div class="level-progress-fill" style="width:0%"></div>
                </div>
                <p>ğŸ”œ å¼€å§‹æŒ‘æˆ˜</p>
            </div>
            
            <div class="level-card" id="level3" onclick="startLevel(3)">
                <div class="level-badge">æŒ‘æˆ˜</div>
                <h3>æŸ¯è¥¿ä¸ç­‰å¼åº”ç”¨</h3>
                <div class="question-preview">
                    <p>åˆ©ç”¨æŸ¯è¥¿ä¸ç­‰å¼ï¼š</p>
                    <p>è‹¥$x + 2y + 3z = 1$ï¼Œæ±‚$x^2 + y^2 + z^2$çš„æœ€å°å€¼ã€‚</p>
                </div>
                <div class="level-progress">
                    <div class="level-progress-fill" style="width:0%"></div>
                </div>
                <p>ğŸ”œ å¼€å§‹æŒ‘æˆ˜</p>
            </div>
        </div>

        <button class="btn btn-secondary" onclick="continueLastLevel()">ç»§ç»­ä¸Šæ¬¡æŒ‘æˆ˜</button>
        <button class="btn" onclick="startLevel(1)">ä»ç¬¬ä¸€å…³å¼€å§‹</button>
    </div>

    <!-- æ¸¸æˆé¡µé¢å®¹å™¨ï¼ˆåˆå§‹éšè—ï¼‰ -->
    <div id="gameContainer" class="game-container" style="display:none;">
        <!-- æ¸¸æˆå†…å®¹å°†é€šè¿‡JSåŠ¨æ€åŠ è½½ -->
    </div>

    <!-- æ·»åŠ KaTeX JS -->
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/contrib/auto-render.min.js"></script>
    
    <script>
        // å…¨å±€å˜é‡
        window.currentLevel = 1;
        const ENTER_KEYCODE = 13;

        // ç”¨æˆ·æ•°æ®åˆå§‹åŒ–
        const initializeUserData = () => ({
            name: "å­¦å‘˜",
            avatar: "æˆ",
            currentChapter: "inequality",
            completedLevels: [],
            lastPlayedLevel: 1,
            scores: {1: 0, 2: 0, 3: 0},
            achievements: {
                "first_level": { unlocked: false, date: "" },
                "inequality_master": { unlocked: false }
            },
            totalLevels: 3,
            wrongAttempts: {1: 0, 2: 0, 3: 0}
        });

        let userData = initializeUserData();

        // æ­£ç¡®ç­”æ¡ˆ
        const correctAnswers = {
            1: { value: "81/4", decimal: 20.25 },
            2: {
                a: { value: "9/4", decimal: 2.25 },
                b: { value: "âˆš2/2", decimal: 0.7071 }
            },
            3: { 
                a: { value: "3", decimal: 3 },
                b: { value: "9", decimal: 9 },
                c: { value: "24", decimal: 24 }
            }
        };

        // ç« èŠ‚æ•°æ®
        const chapters = {
            "inequality": {
                name: "é‡è¦ä¸ç­‰å¼",
                description: "æœ¬ç« å­¦ä¹ å‡å€¼ä¸ç­‰å¼ã€æŸ¯è¥¿ä¸ç­‰å¼ç­‰é‡è¦ä¸ç­‰å¼åŠå…¶åœ¨ç§‘æŠ€é¢†åŸŸçš„åº”ç”¨",
                levels: 3
            },
            "function": {
                name: "å‡½æ•°ä¸æé™",
                description: "æŒæ¡å‡½æ•°æ€§è´¨å’Œæé™è®¡ç®—æ–¹æ³•",
                levels: 4
            },
            "derivative": {
                name: "å¯¼æ•°ä¸åº”ç”¨",
                description: "å­¦ä¹ å¯¼æ•°è®¡ç®—åŠå…¶åœ¨å®é™…é—®é¢˜ä¸­çš„åº”ç”¨",
                levels: 5
            },
            "integral": {
                name: "ç§¯åˆ†å­¦",
                description: "ç†è§£ç§¯åˆ†æ¦‚å¿µå’Œè®¡ç®—æ–¹æ³•",
                levels: 4
            }
        };

        // åŠ è½½ä¿å­˜çš„æ•°æ®
        function loadUserData() {
            try {
                const savedData = localStorage.getItem('mathChallengeData');
                if (savedData) {
                    userData = {...initializeUserData(), ...JSON.parse(savedData)};
                }
            } catch (e) {
                console.error('åŠ è½½æ•°æ®å¤±è´¥:', e);
            }
        }

        // ä¿å­˜æ•°æ®
        function saveUserData() {
            try {
                localStorage.setItem('mathChallengeData', JSON.stringify(userData));
            } catch (e) {
                console.error('ä¿å­˜æ•°æ®å¤±è´¥:', e);
            }
        }

        // åˆ†æ•°è½¬æ¢ä¸ºå°æ•°
        function fractionToDecimal(fraction) {
            try {
                if (!fraction) return null;
                
                // å¤„ç†æ ¹å·å½¢å¼
                if (fraction.includes('âˆš')) {
                    const parts = fraction.split('âˆš');
                    const rootValue = parts[1].split('/')[0];
                    const denominator = parts[1].includes('/') ? parts[1].split('/')[1] : 1;
                    return (Math.sqrt(parseFloat(rootValue)) / parseFloat(denominator)).toFixed(4);
                }
                
                // å¤„ç†åˆ†æ•°å½¢å¼
                if (fraction.includes('/')) {
                    const [numerator, denominator] = fraction.split('/');
                    return parseFloat(numerator) / parseFloat(denominator);
                }
                
                // ç›´æ¥æ•°å­—
                return parseFloat(fraction);
            } catch (e) {
                return null;
            }
        }

        // æ£€æŸ¥ä¸¤ä¸ªæ•°å€¼æ˜¯å¦è¿‘ä¼¼ç›¸ç­‰
        function isApproximatelyEqual(a, b, tolerance = 0.01) {
            a = parseFloat(a);
            b = parseFloat(b);
            return Math.abs(a - b) < tolerance;
        }

        // æ£€æŸ¥ç¬¬ä¸‰é¢˜ç¬¬ä¸‰é—®çš„ç­”æ¡ˆ
        function checkAnswer3c(answer) {
            if (!answer) return false;
            
            answer = answer.toLowerCase().trim();
            const validAnswers = [
                "24", 
                "m<=24", "m â‰¤ 24", "m< =24",
                "må°äºç­‰äº24", "mä¸å¤§äº24",
                "<=24", "â‰¤24"
            ];
            
            return validAnswers.includes(answer);
        }

        // æ¸²æŸ“æ•°å­¦å…¬å¼
        function renderMath() {
            if (typeof renderMathInElement === 'function') {
                renderMathInElement(document.body, {
                    delimiters: [
                        {left: '$$', right: '$$', display: true},
                        {left: '$', right: '$', display: false},
                        {left: '\\(', right: '\\)', display: false},
                        {left: '\\[', right: '\\]', display: true}
                    ],
                    throwOnError: false
                });
            }
        }

        // æ›´æ–°æ˜Ÿæ˜Ÿæ˜¾ç¤º
        function updateStars() {
            const completedCount = userData.completedLevels.length;
            for (let i = 1; i <= 3; i++) {
                const star = document.getElementById(`star${i}`);
                if (star) {
                    star.classList.toggle('active', i <= completedCount);
                }
            }
        }

        // åˆå§‹åŒ–é¦–é¡µ
        function initHomePage() {
            loadUserData();
            
            // æ›´æ–°ç« èŠ‚ä¿¡æ¯
            const currentChapter = chapters[userData.currentChapter];
            document.getElementById("currentChapter").textContent = currentChapter.name;
            document.getElementById("chapterDesc").textContent = currentChapter.description;
            
            // æ›´æ–°è¿›åº¦
            updateProgress();
            
            // æ›´æ–°å…³å¡çŠ¶æ€
            updateLevelCards();
            
            // æ›´æ–°æ€»è¿›åº¦
            updateOverallProgress();
            
            // æ›´æ–°æ˜Ÿæ˜Ÿ
            updateStars();
            
            // æ¸²æŸ“æ•°å­¦å…¬å¼
            setTimeout(renderMath, 50);
        }

        // æ›´æ–°æ€»ä½“è¿›åº¦
        function updateOverallProgress() {
            const completed = userData.completedLevels.length;
            const total = userData.totalLevels;
            const percent = (completed / total) * 100;
            
            const progressBar = document.getElementById("overallProgress");
            if (progressBar) {
                progressBar.style.width = `${percent}%`;
            }
            
            const completedCount = document.getElementById("completedCount");
            if (completedCount) {
                completedCount.textContent = completed;
            }
            
            const totalCount = document.getElementById("totalCount");
            if (totalCount) {
                totalCount.textContent = total;
            }
        }

        // æ›´æ–°ç« èŠ‚è¿›åº¦
        function updateProgress() {
            const currentChapter = chapters[userData.currentChapter];
            const completed = userData.completedLevels.filter(l => l <= currentChapter.levels).length;
            const percent = (completed / currentChapter.levels) * 100;
            
            const progressBar = document.getElementById("chapterProgress");
            if (progressBar) {
                progressBar.style.width = `${percent}%`;
            }
            
            const progressText = document.getElementById("progressText");
            if (progressText) {
                progressText.textContent = `${completed}/${currentChapter.levels}`;
            }
        }

        // æ›´æ–°å…³å¡å¡ç‰‡çŠ¶æ€
        function updateLevelCards() {
            for (let i = 1; i <= 3; i++) {
                const card = document.getElementById(`level${i}`);
                if (!card) continue;
                
                const progress = card.querySelector('.level-progress-fill');
                const statusText = card.querySelector("p:last-child");
                
                if (userData.completedLevels.includes(i)) {
                    card.classList.add("completed");
                    if (progress) progress.style.width = "100%";
                    if (statusText) statusText.innerHTML = "â­ å·²å®Œæˆ";
                } else {
                    card.classList.remove("completed");
                    const score = userData.scores[i] || 0;
                    if (progress) progress.style.width = `${score}%`;
                    if (statusText) {
                        statusText.textContent = score > 0 
                            ? `ğŸ… å·²å¾— ${score}åˆ†` 
                            : "ğŸ”œ å¼€å§‹æŒ‘æˆ˜";
                    }
                }
            }
        }

        // å¼€å§‹å…³å¡
        function startLevel(levelNum) {
            window.currentLevel = levelNum;
            userData.lastPlayedLevel = levelNum;
            saveUserData();
            
            document.getElementById("homePage").style.display = "none";
            const gameContainer = document.getElementById("gameContainer");
            gameContainer.style.display = "block";
            gameContainer.innerHTML = generateLevelHTML(levelNum);
            
            // ç»‘å®šå›è½¦é”®æäº¤
            document.querySelectorAll('.answer-input input').forEach(input => {
                input.addEventListener('keypress', (e) => {
                    if (e.keyCode === ENTER_KEYCODE) {
                        checkAnswer(levelNum);
                    }
                });
            });
            
            renderMath();
        }

        // ç”Ÿæˆå…³å¡HTML
        function generateLevelHTML(levelNum) {
            return `
                <button class="back-button" id="backHomeBtn">â† è¿”å›é¦–é¡µ</button>
                <div class="question-card">
                    <h2>ç¬¬${levelNum}å…³ï¼š${getLevelTitle(levelNum)}</h2>
                    ${generateQuestionContent(levelNum)}
                    
                    ${generateAnswerInputs(levelNum)}
                    
                    <button class="btn" id="submitAnswerBtn">æäº¤ç­”æ¡ˆ</button>
                    <div id="solutionButton${levelNum}" style="display:none;margin-top:10px;">
                        <button class="btn btn-secondary" id="showSolutionBtn">æ˜¾ç¤ºè§£ç­”</button>
                    </div>
                    
                    <div id="solution${levelNum}" style="display:none; margin-top:20px; padding:15px; background:#f9f9f9; border-radius:5px;">
                        ${generateSolutionContent(levelNum)}
                    </div>
                </div>
            `;
        }

        // è·å–å…³å¡æ ‡é¢˜
        function getLevelTitle(levelNum) {
            const titles = {
                1: "ä¹˜ç§¯æœ€å¤§å€¼é—®é¢˜",
                2: "åŠåœ†é¢ç§¯æœ€å¤§é—®é¢˜",
                3: "æŸ¯è¥¿ä¸ç­‰å¼åº”ç”¨"
            };
            return titles[levelNum] || `ç¬¬${levelNum}å…³`;
        }

        // ç”Ÿæˆé—®é¢˜å†…å®¹
        function generateQuestionContent(levelNum) {
            const questions = {
                1: `
                    <p>å¤§ä¼šæ ‡è¯†ä¸­çš„é˜´é˜³æ‚¬è‡‚ä»£è¡¨æ•°å­—$2$å’Œ$7$ï¼Œä¹˜ç§¯ä¸º$14$(å±Šæ•°)ã€‚è‹¥ä¸¤æ•°ä¹‹å’Œä¸º$9$ï¼Œæ±‚å…¶ç§¯çš„æœ€å¤§å€¼ã€‚</p>
                `,
                2: `
                    <p>1ï¼å¦‚å›¾ï¼Œç‚¹ $D$ æ˜¯ä»¥ $A B$ ä¸ºç›´å¾„ä¸º 3 çš„åŠåœ†ä¸Šçš„åŠ¨ç‚¹ï¼Œå½“ $S_{\\triangle A B D}$ å–å¾—æœ€å¤§å€¼æ—¶</p>
                    <div class="question-image">
                        <img src="image/å›¾ç‰‡1.png" alt="åŠåœ†ç¤ºæ„å›¾">
                    </div>
                    <ol type="a">
                        <li>æ±‚é¢ç§¯çš„æœ€å¤§å€¼</li>
                        <li>æ±‚æ­¤æ—¶ç›´çº¿ $A B$ ä¸ç›´çº¿ AD å¤¹è§’çš„ä½™å¼¦å€¼</li>
                    </ol>
                `,
                3: `
                    <p>æˆ‘ä»¬åˆ©ç”¨å®Œå…¨å¹³æ–¹å…¬å¼å¾—å‡ºäº†ä¸€ç±»é‡è¦ä¸ç­‰å¼ï¼š$\\forall a, b \\in \\mathrm{R}, a^{2}+b^{2} \\geq 2 a b$ ï¼Œå½“ä¸”ä»…å½“ $a=b$ æ—¶ï¼Œç­‰å·æˆç«‹ï¼æˆ‘ä»¬ä»ä¸ç­‰å¼ $a^{2}+b^{2} \\geq 2 a b$ å‡ºå‘ï¼Œå¯ä»¥å¾—åˆ°ä¸€ä¸ªéå¸¸ä¼˜ç¾çš„ä¸ç­‰å¼â€”â€”æŸ¯è¥¿ä¸ç­‰å¼ï¼ŒæŸ¯è¥¿ä¸ç­‰å¼çš„ä¸€èˆ¬å½¢å¼ä¸ºï¼š$\\forall a_{1}, a_{2}, \\cdots, a_{n}, b_{1}, b_{2}, \\cdots, b_{n} \\in \\mathrm{R}$ ï¼Œä¸” $b_{1} b_{2} \\cdots b_{n} \\neq 0$ ï¼Œ $\\left(a_{1}^{2}+a_{2}^{2}+\\cdots+a_{n}^{2}\\right)\\left(b_{1}^{2}+b_{2}^{2}+\\cdots+b_{n}^{2}\\right) \\geq\\left(a_{1} b_{1}+a_{2} b_{2}+\\cdots+a_{n} b_{n}\\right)^{2}$ ï¼Œå½“ä¸”ä»…å½“ $\\frac{a_{1}}{b_{1}}=\\frac{a_{2}}{b_{2}}=\\cdots=\\\\frac{a_{n}}{b_{n}}$ æ—¶ï¼Œç­‰å·æˆç«‹ã€‚</p>
                    <ol type="a">
                        <li>è‹¥ $x+2 y+2 z=3 \\sqrt{3}$ ï¼Œæ±‚ $x^{2}+y^{2}+z^{2}$ çš„æœ€å°å€¼ï¼›</li>
                        <li>æ±‚ $\\sqrt{x}+\\sqrt{3 x-32}+\\sqrt{17-x}$ çš„æœ€å¤§å€¼ï¼›ï¼ˆé€‰åšï¼‰</li>
                        <li>è‹¥ $a>3, b>3$ ï¼Œä¸ç­‰å¼ $a^{3}+b^{3}-3 a^{2}-3 b^{2} \\geq m(a-3)(b-3)$ æ’æˆç«‹ï¼Œæ±‚ $m$ çš„å–å€¼èŒƒå›´ï¼ï¼ˆé€‰åšï¼‰</li>
                    </ol>
                `
            };
            return questions[levelNum] || '<p>é—®é¢˜å†…å®¹åŠ è½½ä¸­...</p>';
        }

        // ç”Ÿæˆç­”æ¡ˆè¾“å…¥åŒºåŸŸ
        function generateAnswerInputs(levelNum) {
            const inputs = {
                1: `
                    <div class="answer-input">
                        <label for="answer1">ç§¯çš„æœ€å¤§å€¼ï¼š</label>
                        <input type="text" id="answer1" placeholder="è¯·è¾“å…¥ç­”æ¡ˆï¼ˆå¦‚81/4æˆ–20.25ï¼‰">
                        <div class="error-message" id="error1"></div>
                        <div class="success-message" id="success1"></div>
                    </div>
                `,
                2: `
                    <div class="answer-input">
                        <label for="answer2a">é¢ç§¯çš„æœ€å¤§å€¼ï¼š</label>
                        <input type="text" id="answer2a" placeholder="è¯·è¾“å…¥ç­”æ¡ˆï¼ˆå¦‚9/4æˆ–2.25ï¼‰">
                        <div class="error-message" id="error2a"></div>
                        <div class="success-message" id="success2a"></div>
                    </div>
                    <div class="answer-input">
                        <label for="answer2b">ä½™å¼¦å€¼ï¼š</label>
                        <input type="text" id="answer2b" placeholder="è¯·è¾“å…¥ç­”æ¡ˆï¼ˆå¦‚âˆš2/2æˆ–0.71ï¼‰">
                        <div class="error-message" id="error2b"></div>
                        <div class="success-message" id="success2b"></div>
                    </div>
                `,
                3: `
                    <div class="answer-input">
                        <label for="answer3a">æœ€å°å€¼ï¼š</label>
                        <input type="text" id="answer3a" placeholder="è¯·è¾“å…¥ç¬¬ä¸€ä¸ªç­”æ¡ˆ">
                        <div class="error-message" id="error3a"></div>
                        <div class="success-message" id="success3a"></div>
                    </div>
                    <div class="answer-input">
                        <label for="answer3b">æœ€å¤§å€¼ï¼š</label>
                        <input type="text" id="answer3b" placeholder="è¯·è¾“å…¥ç¬¬äºŒä¸ªç­”æ¡ˆ">
                        <div class="error-message" id="error3b"></div>
                        <div class="success-message" id="success3b"></div>
                    </div>
                    <div class="answer-input">
                        <label for="answer3c">mçš„å–å€¼èŒƒå›´ï¼š</label>
                        <input type="text" id="answer3c" placeholder="è¯·è¾“å…¥24æˆ–m<=24æˆ–må°äºç­‰äº24">
                        <div class="error-message" id="error3c"></div>
                        <div class="success-message" id="success3c"></div>
                    </div>
                `
            };
            return inputs[levelNum] || '';
        }

        // ç”Ÿæˆè§£ç­”å†…å®¹
        function generateSolutionContent(levelNum) {
            const solutions = {
                1: `
                    <h4>è§£ç­”ï¼š</h4>
                    <p>æ ¹æ®é‡è¦ä¸ç­‰å¼ï¼Œ$a b \\leq \\frac{(a+b)^{2}}{4}=\\frac{81}{4}$ ï¼Œå½“ä¸”ä»…å½“ $a=b=\\frac{9}{2}$ æ—¶å–ç­‰ï¼</p>
                    <p><strong>ç­”æ¡ˆï¼š</strong>ç§¯çš„æœ€å¤§å€¼ä¸º$\\frac{81}{4}$(20.25)</p>
                `,
                2: `
                    <h4>è§£ç­”ï¼š</h4>
                    <p>$\\because A B$ ä¸ºåŠåœ†çš„ç›´å¾„ï¼Œ$\\therefore B D \\perp A D$
                        \\[\\therefore S_{\\triangle A B D}=\\frac{1}{2} B D \\cdot A D\\]
æ ¹æ®é‡è¦ä¸ç­‰å¼ï¼Œæœ‰ $B D^{2}+A D^{2} \\geq 2 B D \\cdot A D$,
$\\therefore S_{\\triangle A B D}=\\frac{1}{2} B D \\cdot A D \\leq \\frac{1}{4}\\left(B D^{2}+A D^{2}\\right)$ ï¼
åˆ $\\because B D \\perp A D, \\therefore S_{\\triangle A B D}=\\\\frac{1}{2} B D \\cdot A D \\leq \\frac{1}{4}\\left(B D^{2}+A D^{2}\\right)=\\frac{1}{4} A B^{2}=\\\\frac{9}{4}$ ï¼
å½“ä¸”ä»…å½“ $B D=A D=\\frac{3 \\sqrt{3}}{2}$ æ—¶å–ç­‰ï¼Œæ­¤æ—¶ä¸‰è§’å½¢ä¸ºç­‰è…°ç›´è§’ä¸‰è§’å½¢ï¼Œæ•… $\\cos A=\\frac{\\sqrt{2}}{2}$ ï¼</p>
                   
                    <p><strong>ç­”æ¡ˆï¼š</strong>é¢ç§¯çš„æœ€å¤§å€¼ä¸º$\\frac{9}{4}$(2.25)ï¼Œæ­¤æ—¶ä½™å¼¦å€¼ä¸º$\\frac{\\\\sqrt{2}}{2}$(â‰ˆ0.71)</p>
                `,
                3: `
                    <h4>è§£ç­”ï¼š</h4>
                    <div class="math-formula">
                        ï¼ˆ1ï¼‰ç”±æŸ¯è¥¿ä¸ç­‰å¼ï¼š$\\left(x^{2}+y^{2}+z^{2}\\right)\\left(1^{2}+2^{2}+2^{2}\\right) \\geq(x+2 y+2 z)^{2}=27$ ï¼
$\\Rightarrow x^{2}+y^{2}+z^{2} \\geq 3$ ï¼Œå½“ä¸”ä»…å½“ $\\frac{x}{1}=\\frac{y}{2}=\\frac{z}{2}$ ï¼Œå³ $y=z=\\frac{2 \\sqrt{3}}{3}, x=\\frac{\\sqrt{3}}{3}$ æ—¶å–ç­‰å·ï¼
æ‰€ä»¥ $x^{2}+y^{2}+z^{2}$ çš„æœ€å°å€¼ä¸º 3 ï¼
                    </div>
                    <div class="math-formula">
                        ï¼ˆ2ï¼‰å› ä¸ºæŸ¯è¥¿ä¸ç­‰å¼å¯å¾— $[x+3 x-32+4(17-x)]\\left[1^{2}+1^{2}+\\left(\\frac{1}{2}\\right)^{2}\\right] \\geq(\\sqrt{x}+\\sqrt{3 x-32}+\\sqrt{17-x})^{2}$ ï¼Œ
åˆå› ä¸º $x+3 x-32+4(17-x)=36$ ï¼Œ
æ‰€ä»¥ $36\\left[1^{2}+1^{2}+\\left(\\frac{1}{2}\\right)^{2}\\right] \\geq(\\sqrt{x}+\\sqrt{3 x-32}+\\sqrt{17-x})^{2}$ ï¼Œ
å³å¾— $(\\sqrt{x}+\\sqrt{3 x-32}+\\sqrt{17-x})^{2} \\leq 81$ ï¼ŒåŒ–ç®€å¾— $\\sqrt{x}+\\sqrt{3 x-32}+\\sqrt{17-x} \\leq 9$ ï¼Œ
å½“ä¸”ä»…å½“ $x=16$ å–æœ€å¤§å€¼ 9 ï¼›
                    </div>
                    <div class="math-formula">
                       ï¼ˆ3ï¼‰å› ä¸º $a^{3}+b^{3}-3 a^{2}-3 b^{2} \\geq m(a-3)(b-3)$ ï¼Œ
æ‰€ä»¥ $a^{2}(a-3)+b^{2}(b-3) \\geq m(a-3)(b-3)$ ï¼Œæ‰€ä»¥ $\\frac{a^{2}}{b-3}+\\frac{b^{2}}{a-3} \\geq m$ ï¼Œ
æ‰€ä»¥ $m \\leq\\left(\\frac{a^{2}}{b-3}+\\frac{b^{2}}{a-3}\\right)_{\\text {min }}$ ï¼Œå› ä¸ºæŸ¯è¥¿ä¸ç­‰å¼å¯å¾— $\\left(\\frac{a^{2}}{b-3}+\\frac{b^{2}}{a-3}\\right)(b-3+a-3) \\geq(a+b)^{2}$ ï¼Œ
åˆå› ä¸º $a>3, b>3$ ï¼Œæ‰€ä»¥ $a+b>6$ ï¼Œä»¤ $t=a+b-6$ ï¼Œ
æ‰€ä»¥ $\\left(\\frac{a^{2}}{b-3}+\\frac{b^{2}}{a-3}\\right) \\geq \\frac{(a+b)^{2}}{a+b-6}=\\frac{(t+6)^{2}}{t}=t+\\frac{36}{t}+12 \\geq 2 \\sqrt{t \\times \\frac{36}{t}}+12=24$ ï¼Œ
å³å¾— $\\left(\\frac{a^{2}}{b-3}+\\frac{b^{2}}{a-3}\\right)_{\\text {min }}=24$ ï¼Œå½“ä¸”ä»…å½“ $a=b=6$ å–æœ€å°å€¼ 24 ï¼›
æ‰€ä»¥ $m$ çš„å–å€¼èŒƒå›´æ˜¯ $m \\leq 24$ ï¼
                    </div>
                    <p><strong>ç­”æ¡ˆï¼šï¼ˆ1ï¼‰3  ï¼ˆ2ï¼‰ 9  ï¼ˆ3ï¼‰$m \\leq 24$ </strong></p>
                `
            };
            return solutions[levelNum] || '<p>è§£ç­”å†…å®¹åŠ è½½ä¸­...</p>';
        }

        // æ£€æŸ¥ç­”æ¡ˆï¼ˆæ ¸å¿ƒä¿®å¤éƒ¨åˆ†ï¼‰
        async function checkAnswer(levelNum) {
            const submitBtn = document.getElementById('submitAnswerBtn');
            if (!submitBtn) return;

            // é˜²æ­¢é‡å¤æäº¤
            submitBtn.classList.add('loading');
            submitBtn.disabled = true;

            // æ¨¡æ‹Ÿå¼‚æ­¥å¤„ç†
            await new Promise(resolve => setTimeout(resolve, 300));
            
            try {
                let allCorrect = true;
                const answerData = getAnswersForLevel(levelNum);

                // éªŒè¯æ¯ä¸ªç­”æ¡ˆ
                for (const [key, { value, decimal }] of Object.entries(answerData)) {
                    const elementId = `answer${key}`;
                    const inputElement = document.getElementById(elementId);
                    
                    if (!inputElement || !inputElement.value.trim()) {
                        showValidationMessage(key, 'è¯·å¡«å†™ç­”æ¡ˆ', 'error');
                        allCorrect = false;
                        continue;
                    }

                    const userAnswer = inputElement.value.trim();
                    let isCorrect = false;
                    
                    if (levelNum === 3 && key === 'c') {
                        isCorrect = checkAnswer3c(userAnswer);
                    } else {
                        const userDecimal = fractionToDecimal(userAnswer);
                        isCorrect = userDecimal !== null && (
                            isApproximatelyEqual(userDecimal, decimal) || 
                            userAnswer === value
                        );
                    }

                    if (!isCorrect) {
                        recordWrongAttempt(levelNum);
                        allCorrect = false;
                    }

                    showValidationMessage(
                        key,
                        isCorrect ? 'âœ“ ç­”æ¡ˆæ­£ç¡®ï¼' : 'âœ— ç­”æ¡ˆé”™è¯¯ï¼Œè¯·å†è¯•ä¸€æ¬¡',
                        isCorrect ? 'success' : 'error'
                    );
                }

                if (allCorrect) {
                    completeLevel(levelNum);
                } else if (userData.wrongAttempts[levelNum] >= 3) {
                    document.getElementById(`solutionButton${levelNum}`).style.display = 'block';
                }

            } catch (error) {
                console.error('æ£€æŸ¥ç­”æ¡ˆå‡ºé”™:', error);
                alert('å¤„ç†ç­”æ¡ˆæ—¶å‡ºé”™ï¼Œè¯·é‡è¯•');
            } finally {
                submitBtn.classList.remove('loading');
                submitBtn.disabled = false;
            }
        }

        // è·å–å½“å‰å…³å¡çš„ç­”æ¡ˆé…ç½®
        function getAnswersForLevel(levelNum) {
            const configs = {
                1: {
                    '1': { value: correctAnswers[1].value, decimal: correctAnswers[1].decimal }
                },
                2: {
                    '2a': { value: correctAnswers[2].a.value, decimal: correctAnswers[2].a.decimal },
                    '2b': { value: correctAnswers[2].b.value, decimal: correctAnswers[2].b.decimal }
                },
                3: {
                    '3a': { value: correctAnswers[3].a.value, decimal: correctAnswers[3].a.decimal },
                    '3b': { value: correctAnswers[3].b.value, decimal: correctAnswers[3].b.decimal },
                    '3c': { value: correctAnswers[3].c.value, decimal: correctAnswers[3].c.decimal }
                }
            };
            return configs[levelNum] || {};
        }

        // æ˜¾ç¤ºéªŒè¯æ¶ˆæ¯
        function showValidationMessage(prefix, message, type) {
            const errorEl = document.getElementById(`error${prefix}`);
            const successEl = document.getElementById(`success${prefix}`);
            
            if (type === 'error') {
                if (errorEl) {
                    errorEl.textContent = message;
                    errorEl.style.display = 'block';
                }
                if (successEl) successEl.style.display = 'none';
            } else {
                if (successEl) {
                    successEl.textContent = message;
                    successEl.style.display = 'block';
                }
                if (errorEl) errorEl.style.display = 'none';
            }
        }

        // è®°å½•é”™è¯¯å°è¯•
        function recordWrongAttempt(levelNum) {
            if (!userData.wrongAttempts[levelNum]) {
                userData.wrongAttempts[levelNum] = 1;
            } else {
                userData.wrongAttempts[levelNum]++;
            }
            saveUserData();
        }

        // å®Œæˆå…³å¡
        function completeLevel(levelNum) {
            if (!userData.completedLevels.includes(levelNum)) {
                userData.completedLevels.push(levelNum);
                userData.scores[levelNum] = 100;
                
                // è§£é”é¦–ä¸ªæˆå°±
                if (levelNum === 1 && !userData.achievements.first_level.unlocked) {
                    userData.achievements.first_level.unlocked = true;
                    userData.achievements.first_level.date = new Date().toLocaleDateString();
                }
                
                // æ£€æŸ¥æ˜¯å¦å®Œæˆæ‰€æœ‰å…³å¡
                if (userData.completedLevels.length === 3) {
                    userData.achievements.inequality_master.unlocked = true;
                }
                
                saveUserData();
                
                setTimeout(() => {
                    alert(`ğŸ‰ æ­å–œæ‚¨å®Œæˆç¬¬ ${levelNum} å…³ï¼`);
                    document.getElementById("homePage").style.display = "block";
                    document.getElementById("gameContainer").style.display = "none";
                    initHomePage();
                }, 500);
            }
        }

        // ç»§ç»­ä¸Šæ¬¡å…³å¡
        function continueLastLevel() {
            startLevel(userData.lastPlayedLevel);
        }

        // æ˜¾ç¤ºæˆå°±ç³»ç»Ÿ
        function showAchievements() {
            alert("æ˜¾ç¤ºå®Œæ•´æˆå°±ç³»ç»Ÿ");
        }

        // æ˜¾ç¤ºå­¦ä¹ æŠ¥å‘Š
        function showReport() {
            alert("æ˜¾ç¤ºè¯¦ç»†å­¦ä¹ æŠ¥å‘Š");
        }

        // æ˜¾ç¤ºé”™é¢˜æœ¬
        function showWrongQuestions() {
            alert("æ˜¾ç¤ºå®Œæ•´é”™é¢˜æœ¬");
        }

        // äº‹ä»¶ç›‘å¬ï¼ˆä¿®å¤ç‚¹å‡»æ— ååº”çš„å…³é”®ï¼‰
        document.addEventListener('click', function(e) {
            // è¿”å›æŒ‰é’®
            if (e.target.id === 'backHomeBtn' || e.target.closest('#backHomeBtn')) {
                document.getElementById("homePage").style.display = "block";
                document.getElementById("gameContainer").style.display = "none";
                initHomePage();
                return;
            }
            
            // æäº¤ç­”æ¡ˆæŒ‰é’®ï¼ˆåŒ…æ‹¬äº‹ä»¶å§”æ‰˜ï¼‰
            if (e.target.id === 'submitAnswerBtn' || e.target.closest('#submitAnswerBtn')) {
                checkAnswer(window.currentLevel);
                return;
            }
            
            // æ˜¾ç¤ºè§£ç­”æŒ‰é’®
            if (e.target.id === 'showSolutionBtn' || e.target.closest('#showSolutionBtn')) {
                const solution = document.getElementById(`solution${window.currentLevel}`);
                if (solution) {
                    solution.style.display = solution.style.display === 'none' ? 'block' : 'none';
                    if (solution.style.display === 'block') {
                        renderMath();
                    }
                }
            }
            
            // å…³å¡å¡ç‰‡ç‚¹å‡»
            const levelCard = e.target.closest('.level-card');
            if (levelCard && !levelCard.classList.contains('locked')) {
                const levelNum = parseInt(levelCard.id.replace('level', ''));
                if (!isNaN(levelNum)) {
                    startLevel(levelNum);
                }
            }
        });

        // é¡µé¢åŠ è½½åˆå§‹åŒ–
        window.onload = function() {
            initHomePage();
            
            // ç« èŠ‚é€‰æ‹©å˜åŒ–
            document.getElementById("chapterSelect")?.addEventListener("change", function() {
                userData.currentChapter = this.value;
                saveUserData();
                updateUI();
            });
        };

        // åˆå§‹åŒ–UIçŠ¶æ€
        function updateUI() {
            document.getElementById("currentChapter").textContent = 
                chapters[userData.currentChapter].name;
            document.getElementById("chapterDesc").textContent = 
                chapters[userData.currentChapter].description;
            
            updateProgress();
            updateLevelCards();
            updateOverallProgress();
            updateStars();
        }
    </script>
</body>
</html>
